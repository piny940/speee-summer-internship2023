.branch-wrapper
  %h1.text-center #{@branch.company.name} #{@branch.name}
  .row.mt-5.d-flex.justify-content-between
    .col
      %h2.h4.mb-3 #{@branch.catchphrase}
      %div.text-muted #{@branch.introduction}
    
    .col-3.d-flex.justify-content-end
      %img.img-fluid{ alt: "ロゴ画像", src: "#{@branch.logo_url}" }/

  .row.mt-5.pb-5
    .col.text-center.position-relative.graphics
      - sale_score = number_with_precision(@branch.average_satisfactions, precision: 1)
      .d-flex.align-items-center.justify-content-center.canvas-wrapper
        %canvas#myChart
        %p.position-absolute.score-point= sale_score
      %p.d-flex.justify-content-center.m-0
        %p.fw-bold.m-0 売却スコア
        %div= render 'branches/display_stars', sale_score: sale_score.to_i, range: @score_range
        %div= sale_score

    .col.branch-info
      .fw-bold.mb-3 #{@branch.company.name}について
      %ul.list-unstyled
        %li 企業名：#{@branch.company.name}
        %li 郵便番号：#{@branch.post_number}
        %li 住所：#{@branch.city.prefecture.name}#{@branch.city.name}#{@branch.address}
        %li 電話番号：#{@branch.phone}
        %li FAX：#{@branch.fax_number}
        %li 営業時間：#{@branch.business_hours}
        %li 定休日：#{@branch.regular_holiday}

  .row.mt-5
    .mb-3.fw-bold #{@branch.company.name}で売却したひとの不動産会社についての口コミ（平均評価★#{@branch.avg_service_satisfaction}）
    
    - @sale_reviews.each do |review|
      = link_to root_path, class: "review-card" do 
        .card.mb-3
          .card-body
            .card-title #{review.title}：★#{review.service_satisfaction}
            .card-text.mt-2 #{review.service_satisfaction_reason}
            .mt-3.text-body-tertiary.d-flex.justify-content-end 成約価格 #{format_price review.final_sale_price}（#{review.city.prefecture.name}#{review.city.name}・#{review.sale_period.strftime("%Y年%m月")}に売却）


  %div=paginate @sale_reviews
  .row.pt-5.d-flex.justify-content-center
    = link_to '#', class: "btn text-center w-auto btn--link" do
      査定依頼をする

%script{src: "https://cdn.jsdelivr.net/npm/chart.js"}

:javascript
  const ctx = document.getElementById("myChart");
  const  myChart = new Chart(ctx, {
    type: 'radar',
    data: {
      labels: ['対応満足', '売却スピード', '売却価格'],  // ラベル名: ワイヤーフレームに記載されている
      datasets: [{
        backgroundColor: "rgba(106, 251, 251, 0.5)",
        borderColor: "rgba(106, 251, 251, 0.9)",
        pointBackgroundColor: "rgba(106, 251, 251, 1)",
        pointBorderColor: "#fff",
        data: [3.5, 4.5, 5]
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: false,
        }
      },
      hover: {
        mode: 'index',
        intersec: false
      },
      pointHitRadius: 75,
      scales: {
        r: {
            angleLines: {
                display: false
            },
            suggestedMin: 0,
            suggestedMax: 5,
            ticks: {
              stepSize: 1
            }
          }
        }
    }
  });
